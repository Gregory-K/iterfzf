[tox]
envlist = py26, py27, py33, py34, py35, py36, pypy
skipsdist = true

[testenv]
skip_install = true
commands =
    python setup.py bundle_fzf {posargs:-O} bdist_wheel -d {distshare}
    pip install -U pip
    pip install -f {distshare} --no-index iterfzf
    python -c "from iterfzf import BUNDLED_EXECUTABLE as e; assert e"
    python -c "from iterfzf import BUNDLED_EXECUTABLE as e; import os; assert os.execl(e, e, '--version') == 0"
    python -c "from iterfzf import iterfzf; assert iterfzf([]) is None"
    python -c "from iterfzf import iterfzf; assert iterfzf([], multi=True) is None"

[testenv:py36]
deps =
    flake8 >= 3.3.0
    flake8-import-order-spoqa >= 1.0.0, < 2.0.0
commands =
    {[testenv]commands}
    flake8 iterfzf.py setup.py

[flake8]
exclude = .tox
import-order-style = spoqa
application-import-names = iterfzf
